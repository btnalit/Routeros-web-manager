# 需求文档

## 介绍

RouterOS中文Web管理界面是一个定制化的Web应用程序，旨在简化RouterOS的网络配置管理。该系统提供直观的中文界面，支持PPPoE、PPTP、L2TP接口配置，以及mihomo容器的一键部署和代理节点管理功能。

## 术语表

- **RouterOS_Manager**: 主要的Web管理系统
- **VPN_Interface**: VPN接口配置模块（PPPoE、PPTP、L2TP）
- **Mihomo_Container**: mihomo代理容器管理模块
- **Proxy_Node**: 代理节点配置实体
- **Traffic_Rule**: 流量引流规则配置
- **Chain_Proxy**: 链式前置代理节点配置

## 需求

### 需求 1: VPN接口配置管理

**用户故事:** 作为网络管理员，我希望能够通过Web界面直接配置PPPoE、PPTP、L2TP接口，以便快速部署和管理VPN连接。

#### 验收标准

1. 当用户访问VPN接口配置页面时，系统应显示PPPoE、PPTP、L2TP三种接口类型的配置选项
2. 当用户选择PPPoE接口类型时，系统应提供用户名、密码、服务名称等必要配置字段
3. 当用户选择PPTP接口类型时，系统应提供服务器地址、用户名、密码、加密选项等配置字段
4. 当用户选择L2TP接口类型时，系统应提供服务器地址、用户名、密码、IPSec预共享密钥等配置字段
5. 当用户提交VPN接口配置时，系统应验证配置参数的有效性并应用到RouterOS

### 需求 2: Mihomo容器一键部署

**用户故事:** 作为系统管理员，我希望能够一键部署mihomo容器，以便快速启用代理服务功能。

#### 验收标准

1. 当用户点击mihomo容器部署按钮时，系统应自动下载并部署mihomo容器
2. 当容器部署完成时，系统应显示部署状态和容器运行信息
3. 当容器部署失败时，系统应显示详细的错误信息和建议解决方案
4. 当容器成功运行时，系统应提供容器管理功能（启动、停止、重启、删除）

### 需求 3: 代理节点配置管理

**用户故事:** 作为网络管理员，我希望能够通过Web界面配置各种协议的代理节点，以便灵活管理代理服务。

#### 验收标准

1. 当用户访问代理节点配置页面时，系统应显示支持的协议列表（VLESS、VMess、Trojan、gRPC、AnyTLS、SS、SOCKS5）
2. 当用户选择VLESS协议时，系统应提供服务器地址、端口、UUID、加密方式、传输协议等配置字段
3. 当用户选择VMess协议时，系统应提供服务器地址、端口、UUID、alterId、加密方式、网络类型等配置字段
4. 当用户选择Trojan协议时，系统应提供服务器地址、端口、密码、SNI、跳过证书验证等配置字段
5. 当用户选择gRPC协议时，系统应提供服务器地址、端口、服务名称、TLS配置等字段
6. 当用户选择AnyTLS协议时，系统应提供服务器地址、端口、TLS配置、证书验证等字段
7. 当用户选择SS协议时，系统应提供服务器地址、端口、密码、加密方式等配置字段
8. 当用户选择SOCKS5协议时，系统应提供服务器地址、端口、用户名、密码等配置字段
9. 当用户配置代理节点时，系统应支持选择链式前置代理节点
10. 当用户保存代理节点配置时，系统应验证配置的完整性和有效性

### 需求 4: 流量引流规则配置

**用户故事:** 作为网络管理员，我希望能够配置流量引流规则，以便将特定内网IP的流量引导到指定的VPN出口。

#### 验收标准

1. 当用户访问流量引流规则配置页面时，系统应显示当前所有配置的规则列表
2. 当用户添加新规则时，系统应提供源IP地址、目标地址、VPN出口选择等配置选项
3. 当用户选择单个内网IP时，系统应提供IP地址输入框和子网掩码选择
4. 当用户选择VPN出口时，系统应显示所有可用的VPN接口列表
5. 当用户保存引流规则时，系统应验证IP地址格式和规则冲突
6. 当规则应用时，系统应将配置同步到RouterOS的路由表和防火墙规则

### 需求 5: 系统配置持久化

**用户故事:** 作为系统管理员，我希望所有配置能够持久化保存，以便系统重启后配置不丢失。

#### 验收标准

1. 当用户保存任何配置时，系统应将配置数据持久化到本地存储
2. 当系统重启时，系统应自动加载之前保存的所有配置
3. 当配置文件损坏时，系统应提供配置恢复和备份功能
4. 当用户导出配置时，系统应生成包含所有配置的JSON文件
5. 当用户导入配置时，系统应验证配置文件格式并应用有效配置

### 需求 6: 中文用户界面

**用户故事:** 作为中文用户，我希望整个Web界面都使用中文，以便更好地理解和操作系统功能。

#### 验收标准

1. 当用户访问任何页面时，系统应显示完整的中文界面
2. 当系统显示错误信息时，系统应提供中文的错误描述和解决建议
3. 当用户查看帮助文档时，系统应提供中文的操作指南和说明
4. 当系统显示状态信息时，系统应使用中文描述连接状态和运行状态
5. 当用户进行配置操作时，系统应提供中文的字段标签和提示信息

### 需求 7: 实时状态监控

**用户故事:** 作为网络管理员，我希望能够实时查看VPN连接状态和代理服务状态，以便及时发现和解决问题。

#### 验收标准

1. 当用户访问状态监控页面时，系统应显示所有VPN接口的连接状态
2. 当VPN连接状态发生变化时，系统应实时更新显示状态
3. 当mihomo容器运行时，系统应显示容器的运行状态和资源使用情况
4. 当代理节点连接测试时，系统应显示连接延迟和可用性状态
5. 当流量引流规则生效时，系统应显示规则匹配的流量统计信息